---
 - name: "Precheck"
   hosts: all
   tasks:
    - name: "Create a file if it does not exist"
      command: "touch /tmp/latestfile"
      args:
         creates: "/tmp/latestfile"
      register: createif

    - name: "Display the file to make sure its created"
      command: "ls -lrt /tmp/latestfile"
      register: displayif
      when: createif is changed

    - debug: var=displayif.stdout

    - name: "Remove the file if it exist"
      command: "rm -rf /tmp/latestfile"
      args:
         removes: "/tmp/latestfile"
      register: removeif
   
   #Pulls the latest subscription data from the Satellite server
   # - name: Refresh the subscription manager
    #  command: date

   #Updates the system information
   # - name: Refresh the subscription manager
   #   command: subscription-manager facts --update
   
    - name: "Disk space of /var/cache/yum - Before clean up"
      command: df -hP /var/cache/yum   
      
    - set_fact:
       cur_date_time_formatted : "{{ lookup('pipe', 'date ' + log_date_time_format | quote ) }} : "
       date_format_for_file_details: '%Y-%m-%d:%H:%M:%S'
      
    - name: Get the stat information of file {{ item }}
      stat:
          path: "{{ item }}"
      register: stat_output
    - set_fact:
        file_stat_output: "{{ stat_output.stat }}"
